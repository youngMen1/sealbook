# 1.代码加锁：不要让“锁”事成为烦心事
# 2.总结
## 2.1.高质量问题
1.加锁解锁没有配对可以用一些代码质量工具协助排插，如Sonar，集成到ide和代码仓库，在编码阶段发现，加上超时自动释放，避免长期占有锁
2.锁超时自动释放导致重复执行的话，可以用锁续期，如redisson的watchdog；或者保证业务的幂等性，重复执行也没问题。

**回复：**这个回答太赞了！

2.超时自动释放锁后怎么避免重复逻辑好难，面试曾被卡，求解。。。

**回复：**
有两个方面：
1. 避免超时，单独开一个线程给锁延长有效期。比如设置锁有效期30s，有个线程每隔10s重新设置下锁的有效期。 
2. 避免重复，业务上增加一个标记是否被处理的字段。或者开一张新表，保存已经处理过的流水号。