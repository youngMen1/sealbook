# 1.基本介绍

## 1.1.消息队列概述 {#1}

消息队列中间件是分布式系统中重要的组件，主要解决应用解耦，异步消息，流量削锋等问题，实现高性能，高可用，可伸缩和最终一致性架构。目前使用较多的消息队列有ActiveMQ，RabbitMQ，ZeroMQ，Kafka，MetaMQ，RocketMQ

## 1.2.消息队列应用场景 {#2}

以下介绍消息队列在实际应用中常用的使用场景。异步处理，应用解耦，流量削锋和消息通讯四个场景。

### 1.2.1.异步处理 {#3}

**场景说明：用户注册后，需要发注册邮件和注册短信。传统的做法有两种 1.串行的方式；2.并行方式**

**1.串行方式：**将注册信息写入数据库成功后，发送注册邮件，再发送注册短信。以上三个任务全部完成后，返回给客户端。

![](/static/image/1537614675382176fd7581f.jpg)

**2.并行方式：**将注册信息写入数据库成功后，发送注册邮件的同时，发送注册短信。以上三个任务完成后，返回给客户端。与串行的差别是，并行的方式可以提高处理的时间

153761465751194bd538f43.jpg

假设三个业务节点每个使用50毫秒钟，不考虑网络等其他开销，则串行方式的时间是150毫秒，并行的时间可能是100毫秒。

因为CPU在单位时间内处理的请求数是一定的，假设CPU1秒内吞吐量是100次。则串行方式1秒内CPU可处理的请求量是7次（1000/150）。并行方式处理的请求量是10次（1000/100）

**小结：**如以上案例描述，传统的方式系统的性能（并发量，吞吐量，响应时间）会有瓶颈。如何解决这个问题呢？

**引入消息队列，将不是必须的业务逻辑，异步处理。改造后的架构如下：**

15376146577116bc14b9626.jpg

按照以上约定，用户的响应时间相当于是注册信息写入数据库的时间，也就是50毫秒。注册邮件，发送短信写入消息队列后，直接返回，因此写入消息队列的速度很快，基本可以忽略，因此用户的响应时间可能是**50毫秒**。因此架构改变后，系统的吞吐量提高到每秒**20 QPS**。比串行提高了3倍，比并行提高了两倍。

### 1.2.2.应用解耦 {#4}

### 1.2.3.流量削锋 {#5}

### 1.2.4.日志处理 {#6}

### 1.2.5.消息通讯 {#7}

## 1.3.消息中间件示例 {#8}

# 2.参考:

Java消息队列总结只需一篇解决ActiveMQ、RabbitMQ、ZeroMQ、Kafka

[https://yq.aliyun.com/articles/661488?spm=a2c4e.11153940.0.0.59e644d2Q1YNVY](https://yq.aliyun.com/articles/661488?spm=a2c4e.11153940.0.0.59e644d2Q1YNVY)

消息中间件ActiveMQ、RabbitMQ、RocketMQ、ZeroMQ、Kafka如何选型？

[https://yq.aliyun.com/articles/619292?spm=a2c4e.11153940.0.0.219638b0RfjjN2](https://yq.aliyun.com/articles/619292?spm=a2c4e.11153940.0.0.219638b0RfjjN2)

RabbitMQ和Kafka成熟度评测

[https://mp.weixin.qq.com/s/2Esqohw8L30Yvw4Dmr53nA?](https://mp.weixin.qq.com/s/2Esqohw8L30Yvw4Dmr53nA?)

